{{extend 'layout.html'}}

<!--

-->
<body class="hack_body">

{{if 'db_contents' in globals():}}
<h2>{{=db_contents}}</h2>
{{else:}}
{{pass}}

{{if 'changed_ecu_list' in globals():}}
<h2>{{=changed_ecu_list}}</h2>
{{else:}}
{{pass}}

{{if 'edited_vehicle' in globals():}}
    <script>
        console.log(" hello2! " + {{=edited_vehicle}});
        jQuery('tr[id={{=edited_vehicle}}]').each(function(){
            var button = $("<td><a id='update_button' href='/UPTANE/default/index'>Push Change</a></td>");
            button.click(function(){
                alert($("#update_button").attr("href"));
                jQuery('input[value={{=edited_vehicle}}]').attr('checked', 'checked');
            });
            button.appendTo(jQuery(this));
        });
    </script>
{{else:}}
{{pass}}

{{if 'available_updates' in globals():}}
    <script>
        console.log(" hello3! " + {{=available_updates}});
        for (i = 0; i < {{=available_updates}}.length; i++){
            console.log( "yepp: " + i);
            console.log({{=available_updates}}[i]);
            var id_num = {{=available_updates}}[i];
            jQuery('tr[id=' + id_num + ']').each(function(){
                var button = $("<td><a id='available_update_button' href='/UPTANE/default/index'>AVAILABLE UPDATE</a></td>");
                button.click(function(){
                    alert($("#available_update_button").attr("href"));
                    jQuery('input[value=id_num]').attr('checked', 'checked');
                });
                button.appendTo(jQuery(this));
            });
        }
    </script>
{{else:}}
{{pass}}

<table class="hack_table" align="center">
<h1 align="center"><tr><td>{{=A('Man-in-the-Middle', _class="tdhack1",callback=URL('hack1'))}}</td><td>{{=A('Director Rollback', _class="tdhack2", callback=URL('hack2'))}}</td>
                    <td>{{=A('Supplier Compromised', _class="tdhack3", callback=URL('hack3'))}}</td><td>{{=A('Director Compromised', _class="tdhack4", callback=URL('hack4'))}}</td>
                    <td>{{=A('Arbitrary Package', _class="tdhack5", callback=URL('hack5'))}}</td><td>{{=A('General Attack', _class="tdhack6", callback=URL('hack6'))}}</td></tr></h1>



<h1 align="center" class="hack_links"><tr><td>{{=A('MITM Restore', _class="fix1", callback=URL('fix1'))}}</td><td>{{=A('Director Rollback Restore', _class="fix2", callback=URL('fix2'))}}</td>
                    <td>{{=A('Supplier Restore', _class="fix3", callback=URL('fix3'))}}</td><td>{{=A('Director Restore', _class="fix4", callback=URL('fix4'))}}</td>
                    <td>{{=A('Update Supplier Key', _class="fix5", callback=URL('fix5'))}}</td><td>{{=A('Update Director Key', _class="fix6", callback=URL('fix6'))}}</td></tr></h1>
</table>
<!--
                    <tr>
                        <td><a class="tdhack1" data-w2p_method="POST" href="/UPTANE/default/hack1"></a></td>
                        <td>{{=A('hello', _class="tdhack2", callback=URL('hack2'))}}</td>
                    </tr>
-->

<h1 align="center"><input type="button" class="safety_btn" onclick="location.href='/UPTANE/default/index';"/></h1>


</body>